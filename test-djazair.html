<!DOCTYPE html>
<html>
<head>
    <title>Test API DjazAir - V√©rification Prix R√©els</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .result { margin: 20px 0; padding: 15px; border: 1px solid #ccc; border-radius: 5px; }
        .success { background-color: #d4edda; border-color: #c3e6cb; }
        .error { background-color: #f8d7da; border-color: #f5c6cb; }
        .info { background-color: #d1ecf1; border-color: #bee5eb; }
        button { padding: 10px 20px; font-size: 16px; cursor: pointer; }
        .price { font-size: 18px; font-weight: bold; margin: 10px 0; }
        .dzd { color: #28a745; }
        .eur { color: #007bff; }
    </style>
</head>
<body>
    <h1>üß™ Test API DjazAir - V√©rification Prix R√©els</h1>
    <p>Ce test va v√©rifier que l'API DjazAir retourne de vrais prix depuis Amadeus</p>
    
    <button onclick="testDjazAirAPI()">üöÄ Tester l'API DjazAir R√©elle</button>
    
    <div id="result"></div>

    <script>
        async function testDjazAirAPI() {
            const testData = {
                origin: 'CDG',
                destination: 'DXB',
                departureDate: '2025-09-17',
                returnDate: '2025-09-24',
                passengers: 1,
                cabinClass: 'ECONOMY',
                currency: 'EUR'
            };

            console.log('üì§ Test DjazAir - Donn√©es:', testData);
            document.getElementById('result').innerHTML = '<div class="info">üîÑ Test de l\'API DjazAir en cours...</div>';

            try {
                const response = await fetch('https://djaz-air.vercel.app/api/djazair-calculate', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(testData)
                });

                const data = await response.json();
                
                console.log('üì• R√©ponse API DjazAir:', data);
                
                if (data.success) {
                    const result = data.data;
                    document.getElementById('result').innerHTML = `
                        <div class="result success">
                            <h3>‚úÖ API DjazAir Fonctionne !</h3>
                            
                            <h4>üìä R√©sultats R√©els depuis Amadeus :</h4>
                            
                            <div class="price">
                                <strong>Vol vers Alger :</strong> ${result.segments.toAlgiers.flight} - ${result.segments.toAlgiers.price}‚Ç¨
                            </div>
                            
                            <div class="price">
                                <strong>Vol depuis Alger :</strong> ${result.segments.fromAlgiers.flight} - ${result.segments.fromAlgiers.price}‚Ç¨
                            </div>
                            
                            <hr>
                            
                            <div class="price eur">
                                <strong>Prix Total EUR :</strong> ${result.totalPriceEUR}‚Ç¨
                            </div>
                            
                            <div class="price dzd">
                                <strong>Prix Total DZD (taux 260) :</strong> ${result.totalPriceDZD.toLocaleString()} DZD
                            </div>
                            
                            <div class="price eur">
                                <strong>Prix Final EUR :</strong> ${result.totalPriceEURConverted}‚Ç¨
                            </div>
                            
                            <p><strong>Message :</strong> ${result.message}</p>
                            
                            <p><em>‚úÖ Ces prix sont r√©els et proviennent de l'API Amadeus !</em></p>
                        </div>
                    `;
                } else {
                    document.getElementById('result').innerHTML = `
                        <div class="error">
                            <h3>‚ùå Erreur API DjazAir</h3>
                            <p><strong>Erreur :</strong> ${data.error}</p>
                        </div>
                    `;
                }

            } catch (error) {
                console.error('‚ùå Erreur:', error);
                document.getElementById('result').innerHTML = `
                    <div class="error">
                        <h3>‚ùå Erreur de Connexion</h3>
                        <p><strong>Message :</strong> ${error.message}</p>
                        <p>V√©rifiez que l'application est bien d√©ploy√©e sur Vercel.</p>
                    </div>
                `;
            }
        }
    </script>
</body>
</html>
